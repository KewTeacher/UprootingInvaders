{% extends 'base.html'%}

{% block content %}

<script type="text/javascript">
		var current_coords = {};
	if (navigator.geolocation) {
		navigator.geolocation.getCurrentPosition(function (position) {
			//initialLocation = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

			//it looks like the geolocation object just won't json stringify so let's build up
			//our own js object with what we need
			current_coords.latitude = position.coords.latitude;
			current_coords.longitude = position.coords.longitude;


			console.log("coords", current_coords);
			document.getElementById("coords").innerHTML = current_coords.latitude.toString() + ', ' + current_coords.longitude.toString();


		});
	}

	function sendPlantinfo(information) {

		console.log("information ",information);

		var data = new FormData();
		data.append('lat', current_coords.latitude);
		data.append('lng', current_coords.longitude);
		data.append('Scientific Name With Author', information.species.scientificName);
		data.append('Common Name', information.species.commonNames[0]);
		//if (information.inv) {
			data.append('Inv', JSON.stringify(information.Inv));
		//}
		//else {
			data.append('Inv', [ ])
       // }
		data.append('Score', information.score);
		data.append('Image', "{{ imagename }}");
		var xhr = new XMLHttpRequest
		xhr.open('POST', '/savingid', false);
		//xhr.onload = function () {console.log(this.responseText)};
		//xhr.setRequestHeader("Content-type", "multipart/form-data");
		xhr.send(data);
		window.location = "/maps";

	}
</script>

	<div>
		{% for datas in data %}
<script>
	//let thisdata = {{ datas | tojson }};

</script>
		<div class="cards">
			<p>Scientific Name {{ datas.species.scientificName }}</p>
			<p>Commmon Names {{ datas.species.commonNames }}</p>
			<p>Accuracy {{ datas['score'] * 100 | round }}%</p>
			{% if  datas['Inv'] %}
			<p>Invasive in: {{ datas['Inv'] }}</p>
			 {% endif %}
			<button type="button" onclick="sendPlantinfo({{ datas }})">Submit</button>
		</div>
		{% endfor %}
		<!---p >This is just to show how to get the user id: {{session['id']}}<-->
		<p>This is to show the coords: <span id="coords"></span></p>
		<img src= "{{image }}"
			 alt ="image"
			 width="450"
			 height="500">

	</div>

{% endblock content %}
